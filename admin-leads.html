<?php
include 'db.php';
$result = mysqli_query($conn, "SELECT * FROM leads ORDER BY id DESC");
?>

<h2>Client Leads</h2>
<table border="1" cellpadding="10">
<tr>
  <th>Name</th>
  <th>Email</th>
  <th>Phone</th>
  <th>Date</th>
</tr>

<?php while($row = mysqli_fetch_assoc($result)) { ?>
<tr>
  <td><?= $row['name'] ?></td>
  <td><?= $row['email'] ?></td>
  <td><?= $row['phone'] ?></td>
  <td><?= $row['created_at'] ?></td>
</tr>
<?php } ?>
</table>

<script>
fetch("/api/leads")
  .then(res => res.json())
  .then(data => {
    const table = document.getElementById("leadsTable");

    data.forEach(l => {
      table.innerHTML += `
        <tr>
          <td>${l.name}</td>
          <td>${l.email}</td>
          <td>${l.phone}</td>
          <td>-</td>
        </tr>
      `;
    });
  });
</script>

